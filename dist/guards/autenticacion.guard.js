"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthenticationGuard=void 0;const auth_service_1=require("../auth/application/auth.service");class AuthenticationGuard{static conActivate(t,e,s){const a=t.headers.authorization;if(a){const t=a.split(" ");if(t.length<2)e.status(401).send("User not logged");else{const a=t[1];auth_service_1.Tokens.validateAccessToken(a).then(t=>{e.locals.payload=t,s()},t=>{e.status(t.status).send(t.message)})}}else e.status(401).send("User not logged")}}exports.AuthenticationGuard=AuthenticationGuard;