"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthUseCase=void 0;const bcryptjs_1=__importDefault(require("bcryptjs")),auth_service_1=require("./auth.service"),role_token_dto_1=require("./role-token.dto");class AuthUseCase{constructor(e){this.repository=e}async loginUseCase(e){const s=await this.repository.loginOperation(e);if(!s)return{status:!1,message:"El usuario no existe"};const{name:t,roles:r,password:o}=s,a={name:t,roles:r,password:o};a.roles=role_token_dto_1.RoleTokenDto(a.roles);return await bcryptjs_1.default.compare(e.password,a.password)?{status:!0,accessToken:auth_service_1.Tokens.generateAccessToken(a),refreshToken:auth_service_1.Tokens.generateRefreshToken()}:{status:!1,message:"Contrase√±a incorrecta"}}}exports.AuthUseCase=AuthUseCase;